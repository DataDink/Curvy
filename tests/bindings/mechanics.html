<!DOCTYPE html>
<html>
   <head>
      <meta charset="utf-8">
      <title>Mechanics</title>
      <link rel="stylesheet" href="http://code.jquery.com/qunit/qunit-1.18.0.css">
      <script src="../../src/polyfills/matches.js"></script>
      <script src="../../src/Curvy.js"></script>
      <script src="../../src/Configuration.js"></script>
      <script src="../../src/services/Services.js"></script>
      <script src="../../src/services/Injector.js"></script>
      <script src="../../src/services/utilities.js"></script>
      <script src="../../src/services/DomWatcher.js"></script>
      <script src="../../src/modules/Modules.js"></script>
      <script src="../../src/modules/Bindings.js"></script>
   </head>
   <body>

      <div view-model="pre-load">
         <div pre-bind></div>
      </div>
      
      <div view-model="post-load">
         <div post-bind></div>
      </div>

      <div id="qunit"></div>
      <div id="qunit-fixture"></div>
      <script src="http://code.jquery.com/qunit/qunit-1.18.0.js"></script>
      <script>
         QUnit.test('Tests', function(ass) {
            var dependency = {};
            var preVm = false;
            var preVmLoaded = false;
            var preVmDep = false;
            var preBindLoaded = false;
            var preBindVm = false;

            var postVm = false;
            var postVmLoaded = false;
            var postVmDep = false;
            var postBindLoaded = false;
            var postBindVm = false;

            Curvy.register.instance('dep', dependency);
            Curvy.register.viewmodel('pre-load', ['dep'], function(dep) {
               preVmLoaded = true;
               preVmDep = dep === dependency;
               preVm = this;
            });
            Curvy.register.binding('pre-bind', ['viewmodel'], function(vm) {
               preBindLoaded = true;
               preBindVm = vm;
            });

            var app = Curvy.create();
            ass.ok(preVmLoaded, 'Pre VM Loaded');
            ass.ok(preVmDep, 'Pre VM Dependency');
            ass.ok(preBindLoaded, 'Pre Bind Loaded');
            ass.ok(preBindVm === preVm, 'Pre Bind VM');
            ass.ok(preVm instanceof Curvy.Observable, 'VM Is Observable');


         });
      </script>
   </body>
</html>
