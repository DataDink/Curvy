var Curvy=function(a){var b=this;Object.defineProperty(b,"configuration",{enumerable:!0,configurable:!1,value:a})};Curvy.Bindings={},Curvy.Services={},Curvy.Modules={},Curvy.Configuration={lifecycle:["init","load"],nodedata:" _Curvy Node Data_ "},function(){function a(){}function b(a){var b=(a||"").split(".");if(!b.length)return!1;var c=b.shift();return c?{path:a,member:c,child:b.join(".")}:!1}function c(b,c,d){return b instanceof Curvy.Observable?b.watch(c,d):a}function d(a,b){for(var c in a)delete b[c],e(c,a,b);Object.freeze(b)}function e(a,b,c){Object.defineProperty(c,a,{enumerable:!0,configurable:!1,get:function(){return"function"==typeof b[a]?function(b){return function(){c.notifyIntercept(a,arguments),b.apply(c,arguments)}}(b[a]):b[a]},set:function(d){b[a]=d,c.notify(a)}})}function f(a,b){return!(Object.getOwnPropertyDescriptor(a,b)||{configurable:!0}).configurable}Curvy.Observable=function(a){var b=this,c=[],e=[];Object.defineProperty(b,"notify",{enumerable:!0,configurable:!1,value:function(a){b.notifyIntercept("notify",arguments);for(var d=0;d<c.length;d++)c[d](a)}}),Object.defineProperty(b,"observe",{enumerable:!0,configurable:!1,value:function(a){b.notifyIntercept("observe",arguments),"function"==typeof a&&c.push(a)}}),Object.defineProperty(b,"unobserve",{enumerable:!0,configurable:!1,value:function(a){b.notifyIntercept("unobserve",arguments),c=c.filter(function(b){return b!==a})}}),Object.defineProperty(b,"intercept",{enumerable:!0,configurable:!1,value:function(a){b.notifyIntercept("intercept",arguments),"function"==typeof a&&e.push(a)}}),Object.defineProperty(b,"release",{enumerable:!0,configurable:!1,value:function(a){b.notifyIntercept("release",arguments),e=e.filter(function(b){return b!==a})}}),Object.defineProperty(b,"notifyIntercept",{enumerable:!0,configurable:!1,value:function(a,b){for(var c=0;c<e.length;c++)e[c](a,b)}}),Object.defineProperty(b,"destroy",{enumerable:!0,configurable:!1,value:function(){b.notifyIntercept("destroy",arguments);var d=void 0;e=d,b=d,c=d,a=d}}),Object.defineProperty(b,"seal",{enumerable:!0,configurable:!1,value:function(){if(b.notifyIntercept("seal",arguments),a)return d(a,b);a={};for(member in b)member in Curvy.Observable.prototype||f(b,member)||(a[member]=b[member]);return d(a,b,c)}})},Object.defineProperty(Curvy.Observable.prototype,"path",{enumerable:!0,configurable:!1,value:function(a){for(var b=this,c=a.split(".")||[];"undefined"!=typeof b&&c.length;)b=b[c.shift()];return b}}),Object.defineProperty(Curvy.Observable.prototype,"watch",{enumerable:!0,configurable:!1,value:function(d,e){if(!(this instanceof Curvy.Observable))return a;var f=this;if(d=b(d),!d)return a;var g=c(f[d.member],d.child,e),h=function(a){a===d.member&&(g(),g=c(f[d.member],d.child,e),e.call(f,d.member))};return f.observe(h),function(){f.unobserve(h),g()}}}),Object.freeze(Curvy.Observable.prototype)}(),function(){var a=!1,b=[],c=document.createElement("div");Curvy.Services.utilities={style:function(c,d){if(!a){a=document.createElement("style");var e=document.querySelectorAll("head")[0]||document.body;e.insertBefore(a,e.firstChild)}c=(c||"").trim().toLowerCase(),c&&(d=c+" { "+(d||"")+" }",b.some(function(a){})||(b.push(d),a.sheet.insertRule(d,a.sheet.rules.length)))},encode:function(a){return a.indexOf('"')<0&&a.indexOf("'")<0&&a.indexOf("<")<0&&a.indexOf(">")<0?a:(a||"").toString().replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&#39;").replace(/</g,"&lt;").replace(/>/g,"&gt;")},parse:function(a){c.innerHTML=a;for(var b=[];c.firstChild;)b.push(c.firstChild),c.removeChild(c.firstChild);return b.length>1?b:b[0]},parseUri:function(a){a=(a||"").replace(/^#+/g,"");var b=a.split("?"),a=(b[0]||"").toLowerCase(),c=b[1]||"",d=Curvy.Services.utilities.parseQuery(b[1]||""),e={uri:a,params:c,data:d};return Object.freeze(e),e},parseQuery:function(a){for(var b={},c=(a||"").replace(/^\?+|^\&+|\&+$/g,"").split("&"),d=0;d<c.length;d++){var e=c[d].split("=");if(2===e.length){var f=decodeURIComponent(e[0]||""),g=decodeURIComponent(e[1]||"");"string"==typeof b[f]?b[f]=[b[f],g]:f in b?b[f].push(g):b[f]=g}}return b},formatUri:function(a,b){if(!b)return a;"string"!=typeof b&&(b=Curvy.Services.utilities.formatParameters(b)),b=b.replace(/^[&?]+/g,"");var c=a.indexOf("?")>=0?a+"&"+b:a+"?"+b;return c.trim().replace(/\?$|&$/gi,"")},formatParameters:function(a){if("string"==typeof a)return a;var b=[];for(var c in a)for(var d=a[c]instanceof Array?a[c]:[a[c]],e=0;e<d.length;e++){var f="undefined"==typeof d[e]?"":d[e];b.push(encodeURIComponent(c)+"="+encodeURIComponent(f))}return b.join("&")}}}(),function(){function a(){var a=new Curvy.Services.Injector;Curvy.register={instance:a.register.instance,singleton:a.register.singleton,contextual:a.register.contextual,"transient":a.register["transient"],service:function(c,d,e){c=b(c).filter(function(a){return"services"!==a}).concat(["services"]),a.register.singleton(c,d,e)},module:function(c,d,e){c=b(c).filter(function(a){return"modules"!==a}).concat(["modules"]),a.register.singleton(c,d,e)}},a.register.instance("configuration",Curvy.Configuration),Curvy.create=function(){var b=a.branch(),c=b.resolve(["configuration",Curvy]);b.register.instance("application",c),Object.defineProperty(c,"dependencies",{enumerable:!0,configurable:!1,value:b});for(var d=b.resolve.all("modules").filter(function(a){return!!a}),e=(c.configuration||{}).lifecycle||[],f=0;f<e.length;f++)for(var g=e[f],h=0;h<d.length;h++){var i=d[h];"function"==typeof i[g]&&i[g]()}return c}}function b(a){return a instanceof Array?a.filter(function(a){return"string"==typeof a}):"string"==typeof a?[a]:[]}function c(a){var b={};for(var c in a)b[c]=a[c];return b}Curvy.Services.Injector=function(){function a(a,b){b=c(b||{}),b.dependencies=i;var g={};if(f(function(a,b){for(var c=0;c<a.length;c++){var d=a[c];g[d]=g[d]||[],b.singleton?g[d].push(b):g[d].push({dependencies:b.dependencies,constructor:b.constructor,singleton:b.singleton,"transient":b["transient"]})}}),"string"==typeof a)return d(a,g,b);if("function"==typeof a)return e([a],g,b);if(a instanceof Array)return e(a,g,b);throw"Unable to resolve "+typeof a}function d(a,b,c){if(a in c)return c[a];if(a in b){for(var d=[],f=b[a],g=0;g<f.length;g++){var h=f[g];if("instance"in h)d.push(h.instance);else{var i=e(h.dependencies.concat([h.constructor]),b,c);h["transient"]||(h.instance=i),d.push(i)}}return d.length<2?d[0]:d}}function e(a,b,c){function e(){a.apply(this,f)}var f=a.filter(function(a){return"string"==typeof a});if(a=a.filter(function(a){return"function"==typeof a})[0],!a)throw"Invalid constructor";for(var g=0;g<f.length;g++)f[g]=d(f[g],b,c);return e.prototype=a.prototype,new e}function f(a){var b=[];for(var c in j)for(var d=j[c],e=0;e<d.length;e++){var f=d[e],g=b.filter(function(a){return a.info===f})[0];g||(g={info:f,names:[]},b.push(g)),g.names.push(c)}for(var e=0;e<b.length;e++){var g=b[e];a(g.names,g.info)}}function g(a,c){a=b(a),c.builder&&(c.constructor=c.builder.pop(),c.dependencies=c.builder,delete c.builder);for(var d=0;d<a.length;d++){var e=a[d];j[e]=j[e]||[],j[e].push(c)}}function h(a,c){if(c="function"==typeof c?c:"function"==typeof a?a:a&&a instanceof Array?a.pop():!1,"function"!=typeof c)throw"Invalid Constructor";return a=b(a),a.concat([c])}var i=this,j={};i.register={instance:function(a,b){g(a,{instance:b,singleton:!0,"transient":!1})},singleton:function(a,b,c){g(a,{builder:h(b,c),singleton:!0,"transient":!1})},contextual:function(a,b,c){g(a,{builder:h(b,c),singleton:!1,"transient":!1})},"transient":function(a,b,c){g(a,{builder:h(b,c),singleton:!1,"transient":!0})}},Object.freeze(i.register),i.resolve=function(b,c){return a(b,c)},i.resolve.all=function(b,c){var d=a(b,c);return d instanceof Array?d:[d]},Object.freeze(i.resolve),i.branch=function(){var a=new Curvy.Services.Injector;return f(function(b,c){c.singleton&&"instance"in c?a.register.instance(b,c.instance):c.singleton?a.register.singleton(b,c.dependencies,c.constructor):c["transient"]?a.register["transient"](b,c.dependencies,c.constructor):a.register.contextual(b,c.dependencies,c.constructor)}),a},Object.freeze(i)},a()}(),Curvy.Services.Broadcast=function(){var a=this,b={};a.subscribe=function(a,c){b[a]=b[a]||[],b[a].push(c)},a.unsubscribe=function(a){for(var c in b)b[c]=b[c].filter(function(b){return b!==a})},a.send=function(a){for(var c=[],d=1;d<arguments.length;d++)c.push(arguments[d]);for(var e=b[a]||[],d=0;d<e.length;d++)e[d].apply(this,c)},Object.freeze(a)},Curvy.register.service("broadcast",Curvy.Services.Broadcast),Curvy.Services.DomWatcher=function(){function a(a){for(var d={added:[],removed:[]},f=0;f<a.length;f++)c(d.added,a[f].addedNodes),c(d.removed,a[f].removedNodes);d.removed=b(d.removed),d.added=b(d.added);for(var g=0;g<e.length;g++)e[g](d)}function b(a){for(var b=[],c=0;c<a.length;c++){var d=a[c];if(!b.some(function(a){return a===d})){for(var e=d.parentNode;e&&!a.some(function(a){return a===e});)e=e.parentNode;e||b.push(d)}}return b}function c(a,b){for(var c=0;b&&c<b.length;c++)a.push(b[c])}var d=this,e=[];d.listen=function(a){"function"==typeof a&&e.push(a)},d.cancel=function(a){e=e.filter(function(b){return b!==a})},Object.freeze(d);var f;!window.MutationObserver&&document.addEventListener?(f=function(){document.addEventListener("DOMNodeInserted",function(a){f.added.push(a.target),f.timeout&&clearTimeout(f.timeout),f.timeout=setTimeout(f.broadcast)}),document.addEventListener("DOMNodeRemoved",function(a){f.removed.push(a.target),f.timeout&&clearTimeout(f.timeout),f.timeout=setTimeout(f.broadcast)}),c(f.added,document.querySelectorAll("*")),f.broadcast()},f.added=[],f.removed=[],f.broadcast=function(){var b={addedNodes:f.added,removedNodes:f.removed};f.added=[],f.removed=[],a([b])},"complete"===document.readyState?f():document.onreadystatechange=function(){"complete"===this.readyState&&f()}):(f=new MutationObserver(a),f.observe(document,{childList:!0,subtree:!0}))},Curvy.register.service("dom-watcher",[],Curvy.Services.DomWatcher),function(){function a(a,d,e,f,g,h,i){g=g?JSON.stringify(g):!1,f=f||function(){},e=e||function(){},i=i||{},h=h||{},h.Accept="application/json",g!==!1&&(h["Content-Type"]="application/json");var j=new XMLHttpRequest;j.open(a,d,i.async!==!1,i.user,i.pass);for(var k in h)j.setRequestHeader(k,h[k]);return i.mimeType&&j.overrideMimeType(i.mimeType),i.withCredentials===!0&&(j.withCredentials=!0),i.timeout&&(j.timeout=timeout),j.onreadystatechange=function(){if(4===this.readyState){var a=b(this),d=c(this.responseText);this.status<200||this.status>=400?f.call(a,d):e.call(a,d)}},j.ontimeout=function(){f({},b(j,!0))},g===!1?j.send():j.send(g),j.abort}function b(a,b){return{timeout:!!b,state:a.readyState,response:a.response,responseText:a.responseText,responseType:a.responseType,status:a.status,statusText:a.statusText,getHeaders:a.getAllResponseHeaders}}function c(a){try{return JSON.parse(a)}catch(b){return console.log(a),{parseError:b}}}var d=Curvy.Services.utilities,e={},f={},g={},h={};Curvy.Services.Http=function(){function b(a,b,c){var d={};for(var e in a)d[e]=a[e];for(var e in b)e in d||(d[e]=b[e]);for(var e in c)e in d||(d[e]=c[e]);return d}function c(a){return b(a,l,e)}function i(a){return b(a,m,f)}function j(a){return"string"==typeof a?a:b(a,n,g)}function k(a){return b(a,o,h)}var l={},m={},n={},o={};this.setGlobalHeader=function(a,b){e[a]=b},this.setGlobalConfig=function(a,b){f[a]=b},this.setGlobalParam=function(a,b){g[a]=b},this.setGlobalQuery=function(a,b){h[a]=b},this.setHeader=function(a,b){l[a]=b},this.setConfig=function(a,b){m[a]=b},this.setParam=function(a,b){n[a]=b},this.setQuery=function(a,b){o[a]=b},this.get=function(b,e,f,g,h,l){return a("get",d.formatUri(b,k(j(e))),f,g,!1,c(h),i(l))},this["delete"]=function(b,e,f,g,h,l){return a("delete",d.formatUri(b,k(j(e))),f,g,!1,c(h),i(l))},this.post=function(b,e,f,g,h,l){return a("post",d.formatUri(b,k({})),f,g,j(e),c(h),i(l))},this.patch=function(b,e,f,g,h,l){return a("patch",d.formatUri(b,k({})),f,g,j(e),c(h),i(l))},this.put=function(b,e,f,g,h,l){return a("put",d.formatUri(b,k({})),f,g,j(e),c(h),i(l))},Object.freeze(this)},Curvy.register["transient"](["http","services"],Curvy.Services.Http)}(),function(){var a=Curvy.Services.utilities;Curvy.Services.Route=function(b){function c(){var a=e;e=d.current;for(var c=d.current,f=h[c.uri]||[],i=0;2>i;i++){for(var j=0;j<f.length;j++)f[j](c,a);f=g}b.send(d.channel,c)}var d=this;this.channel="Route.Updated",Object.defineProperty(d,"channel",{configurable:!1,enumerable:!0,value:"Route.Updated"});var e=!1;Object.defineProperty(d,"current",{configurable:!1,enumerable:!0,get:function(){return a.parseUri(window.location.hash)}});var f={};Object.defineProperty(d,"routes",{configurable:!1,enumerable:!0,get:function(){var a={};for(var b in f)a[b]=f[b];return a}}),Object.defineProperty(d,"register",{configurable:!1,enumerable:!0,value:function(b,c){f[a.parseUri(b).uri]=c}});var g=[],h={};Object.defineProperty(d,"subscribe",{configurable:!1,enumerable:!0,value:function(a,b){var c="function"==typeof a?a:"function"==typeof b?b:!1;if(!c)throw"Invalid Subscription";var b="string"==typeof b?b:"string"==typeof a?a:!1;return b?(h[b]=a[b]||[],void h[b].push(c)):void g.push(c)}}),Object.defineProperty(d,"unsubscribe",{configurable:!1,enumerable:!0,value:function(a){for(var b in h)h[b]=h[b].filter(function(b){return b!==a});g=g.filter(function(b){return b!==a})}}),Object.defineProperty(d,"navigate",{configurable:!1,enumerable:!0,value:function(b,d){window.history&&window.history.pushState?(window.history.pushState(null,null,"#"+a.formatUri(b,d)),c()):window.location.hash=a.formatUri(b,d)}}),window.onpopstate?window.onpopstate=c:window.addEventListener("hashchange",c),Object.freeze(d)},Curvy.register.service("route",["broadcast"],Curvy.Services.Route)}(),function(){function a(){Curvy.register.binding=function(a,d,e){b(c,a,d,e)},Curvy.register.module("binding-manager",["dependencies","dom-watcher","application","configuration"],Curvy.Modules.BindingManager)}function b(a,b,c,d){if(!b)throw"Invalid Binding Name";if(!b.match(/^[a-zA-Z]/gi))throw"Binding name must start with a letter";if(b.match(/[^a-zA-Z0-9\-\_]/gi))throw'Binding names can only contain alpha-numeric characters, "-", and "_".';if(b=b.toLowerCase(),d="function"==typeof d?d:"function"==typeof c?c:c instanceof Array?c.pop():!1,"function"!=typeof d)throw"Invalid Constructor";return c=c||[],c=c instanceof Array?c:[],a[b]=c.concat([d]),b}var c={};Curvy.Modules.BindingManager=function(a,d,e,f){function g(a,b){a=a.filter(function(a){return!m(a)}),b=b||p(u);for(var c=0;c<a.length;c++)for(var d=n(a[c],b),e=0;e<d.length;e++)i(d[e])}function h(a){for(var b=0;b<a.length;b++){var c=a[b];"getElementsByTagName"in c&&[c].concat(c.getElementsByTagName("*")).forEach(function(a){f.nodedata in a&&j(a)})}}function i(b){var c=k(b);for(var d in u){if(m(b))break;if(!(d in c.bindings)&&b.matches&&b.matches(s(d))){var e=r(b),f=u[d].slice(0),g=f.pop(),h=function(){l(this,b),g.apply(this,arguments)};h.prototype=g.prototype;var i=a.resolve(f.concat([h]),e);c.bindings[d]=i}}}function j(a){var b=q(a);if(b){for(var c=0;c<b.disposals.length;c++)b.disposals[c]();for(var d in b.bindings)delete b.bindings[d];for(var d in b.registrations)delete b.registrations[d];for(;b.disposals.length;)b.disposals.pop();delete b.bindings,delete b.registrations,delete b.suspended,delete b.disposals,delete a[f.nodedata]}}function k(a){return a[f.nodedata]=a[f.nodedata]||{bindings:{},registrations:{},suspended:!1,disposals:[]},q(a)}function l(a,b){Object.defineProperty(a,"element",{enumerable:!0,configurable:!1,value:b}),Object.defineProperty(a,"suspend",{enumerable:!0,configurable:!1,value:function(){var a=q(b);return a.suspended=!0,function(){a.suspended=!1,g([b])}}}),Object.defineProperty(a,"register",{enumerable:!0,configurable:!1,value:function(a,c){var d=q(b);d.registrations[a]=c}}),Object.defineProperty(a,"dispose",{enumerable:!0,configurable:!1,value:function(a){var c=q(b);c.disposals.push(a)}})}function m(a){for(var b=a;b;){var c=q(b);if(c&&c.suspended)return!0;b=b.parentNode}return!1}function n(a,b){if(!a||!a.matches)return[];b=b.slice(0);for(var c=0;c<b.length;c++)b[c]=s(b[c]);var d=b.join(", ");if(!d||!d.length)return[];for(var e=a.matches(d)?[{node:a,depth:o(a)}]:[],f=a.querySelectorAll(d),g=0;g<f.length;g++)e.push({node:f[g],depth:o(f[g])});e.sort(function(a,b){return a.depth<b.depth?-1:a.depth>b.depth?1:0});for(var g=0;g<e.length;g++)e[g]=e[g].node;return e}function o(a,b){return a.parentNode?o(a.parentNode,(b||0)+1):b||0}function p(a){var b=[];for(var c in a)b.push(c);return b}function q(a){return a[f.nodedata]}function r(a){for(var b={},c=a;c;){var d=q(c);if(d)for(var e in d.registrations)e in b||(b[e]=d.registrations[e]);c=c.parentNode}return b}function s(a){return"["+a+"]"}var t=this,u={};f=f||e.configuration||Curvy.Configuration,Object.defineProperty(t,"init",{enumerable:!1,configurable:!1,value:function(){for(var a in c)u[a]=c[a];Object.defineProperty(e,"binding",{enumerable:!0,configurable:!1,value:function(a,c,d){a=b(u,a,c,d),g([document.body],[a])}})}}),Object.defineProperty(t,"load",{enumerable:!1,configurable:!1,value:function(){var a=!1;d.listen(function(b){try{if(a)return;h(b.removed),g(b.added)}catch(c){throw a=!0,setTimeout(function(){a=!1},250),console&&console.log&&console.log("Circuit breaker tripped."),c}}),document.body&&g([document.body])}}),Object.defineProperty(t,"override",{enumerable:!0,configurable:!1,value:function(a,b,c){var d=k(a);d.registrations[b]=c}}),Object.defineProperty(t,"dispose",{enumerable:!0,configurable:!1,value:function(a,b){var c=k(a);c.disposals.push(b)}})},a()}(),function(){function a(){Curvy.register.viewmodel=function(a,d,e){if(!a)throw"Invalid Name";c[a]=b(d,e)},Curvy.register.module("viewmodel-manager",["dependencies","application"],Curvy.Modules.ViewModels)}function b(a,b){if(a=a instanceof Array?a.slice(0):a||[],b="function"==typeof b?b:"function"==typeof a?a:a instanceof Array?a.pop():!1,"function"!=typeof b)throw"Invalid Constructor";return a=a instanceof Array?a:[],a.push(b),a}var c={};Curvy.Modules.ViewModels=function(a,d){var e=this,f={},g={};Object.defineProperty(e,"init",{configurable:!1,enumerable:!1,value:function(){for(var a in c)f[a]=c[a];Object.defineProperty(d,"viewmodel",{configurable:!1,enumerable:!0,value:function(a,b,c){e.register(a,b,c)}})}}),Object.defineProperty(e,"register",{configurable:!1,enumerable:!0,value:function(a,c,d){if(!a)throw"Invalid Name";if(f[a]=b(c,d),a in g){for(var e=0;e<g[a].length;e++)g[a][e]();delete g[a]}}}),Object.defineProperty(e,"postpone",{configurable:!1,enumerable:!0,value:function(a,b){g[a]=g[a]||[],g[a].push(b)}}),Object.defineProperty(e,"resolve",{configurable:!1,enumerable:!0,value:function(a,b,c){return a in f?e.create(f[a].slice(0),b,c):!1}}),Object.defineProperty(e,"create",{configurable:!1,enumerable:!0,value:function(b,c,d){function e(){var a=this;Curvy.Observable.call(a),Object.defineProperty(a,"view",{configurable:!1,enumerable:!0,value:d.element}),Object.defineProperty(a,"parent",{configurable:!1,enumerable:!0,value:c}),Object.defineProperty(a,"dispose",{configurable:!1,enumerable:!0,value:function(a){d.dispose(a)}}),g.apply(a,arguments),a.seal()}if(!(b instanceof Array))throw"Invalid Constructor";var f=b.slice(0),g=f.pop();if("function"!=typeof g)throw"Invalid Constructor";return e.prototype=Curvy.Observable.prototype,a.resolve(f.concat([e]))}})},a()}(),function(){function a(a){if(a.matches("input[type=radio]")||a.matches("input[type=checkbox]"))return a.checked;if(a.matches("select")){for(var b=[],c=0;c<a.options.length;c++)a.options[c].selected&&b.push(a.options[c].value);return b.length>1?b:b[0]}return"value"in a?a.value:a.innerHTML||""}function b(a,b){if(a.matches("input[type=radio]")||a.matches("input[type=checkbox]"))return void(a.checked=!!b);{if(!a.matches("select"))return"value"in a?void(a.value=b):void(a.innerHTML=service.encode((b||"").toString()));b instanceof Array||(b=[b]);for(var c=0;c<a.options.length;c++){a.options[c].selected=!1;for(var d=0;d<b.length;d++)a.options[c].value===b[d]&&(a.options[c].selected=!0)}}}Curvy.register.binding("data-bind",["viewmodel"],function(c){function d(){if(!j){k=!0,j=!1;var a=c.path(f);b(e.element,"undefined"==typeof a?"":a),k=!1}}var e=this,f=e.element.getAttribute("data-bind")||!1;if(!f)throw"data-bind must be set to a property / path to watch";var g=f.split("."),h=g.pop(),i=g.join(".");if(h){for(var j=!1,k=!1,l=["click","keyup","change"],m=0;m<l.length;m++)try{e.element.addEventListener(l[m],function(){if(!k){j=!0,k=!1;var b=i?c.path(i):c;b[h]=a(e.element),j=!1}})}catch(n){}c.watch(f,d),d()}})}(),Curvy.register.binding("data-class",["viewmodel"],function(a){function b(a){return"string"!=typeof a||a.length<1?!1:/[^a-zA-Z0-9\-_]/.test(a)?!1:a.toLowerCase()}var c=this,d=this.element.getAttribute("data-class")||"",e=d.indexOf("{")>=0?!1:d,f=d.indexOf("{")<0?!1:d.replace(/^\{+|\}+$/g,"");if(e)for(var g=e.split(/\s+/gi),h={},i=function(d){h[d]!==!1&&c.element.classList.remove(h[d]),h[d]=b(a.path(d)),h[d]&&c.element.classList.add(h[d])},j=0;j<g.length;j++)h[g[j]]=!1,a.watch(g[j],function(a){return function(){i(a)}}(g[j])),i(g[j]);else if(f)for(var k=f.split(","),j=0;j<k.length;j++){var l=k[j].split(":");if(k[j]={"class":b(l[0].trim()),path:l[1].trim()},!k[j]["class"])throw"Invalid Class Name";k[j].update=function(b){return function(){var d=a.path(b.path);c.element.classList.remove(b["class"]),d&&c.element.classList.add(b["class"])}}(k[j]),a.watch(k[j].path,k[j].update),k[j].update()}}),Curvy.register.binding("data-click",["viewmodel"],function(a){var b=this.element.getAttribute("data-click");this.element.addEventListener("click",function(){var c=a.path(b);"function"==typeof c&&c.apply(a,arguments)})}),Curvy.register.binding("data-format",["viewmodel"],function(a){function b(a){return a.replace(/^\{\{|\}\}$/g,"")}function c(){for(var c=e,g=0;g<f.length;g++){var h=f[g],i=a.path(b(h));for(i="undefined"==typeof i?"":i;c.indexOf(h)>=0;)c=c.replace(h,i)}i in d.element?d.element.value=c:d.element.innerHTML=Curvy.Services.utilities.encode(c)}var d=this,e=d.element.getAttribute("data-format")||"",f=e.match(/\{\{[^\}]+\}\}/g);if(f){for(var g=0;g<f.length;g++)a.watch(b(f[g]),c);c()}}),Curvy.register.binding("data-hide",["viewmodel"],function(a){Curvy.Services.utilities.style(".data-hide","display: none !important;");var b=this,c=b.element.getAttribute("data-hide"),d=function(){a.path(c)?b.element.classList.add("data-hide"):b.element.classList.remove("data-hide")};a.watch(c,d),d()}),Curvy.register.binding("data-href",["viewmodel"],function(a){var b=this,c=b.element.getAttribute("data-href"),d=function(){var d=a.path(c)||"";b.element.setAttribute("href",d)};a.watch(c,d),d()}),Curvy.register.binding("data-html",["viewmodel"],function(a){function b(){var b=a.path(d)||"";c.element.innerHTML=b}var c=this,d=c.element.getAttribute("data-html")||"";a.watch(d,b),b()}),Curvy.register.binding("data-routed",["route"],function(a){function b(b,d){if(!d||b.uri!==d.uri){var e=a.routes[b.uri];if(!e)return void(c.element.innerHTML="");var f=new XMLHttpRequest;f.open("get",e,!0),f.onreadystatechange=function(){4===this.readyState&&(this.status<200||this.status>=400?c.element.innerHTML="":c.element.innerHTML=this.responseText)},f.send()}}var c=this;a.subscribe(b),c.dispose(function(){a.unsubscribe(b)}),b(a.current)}),Curvy.register.binding("data-show",["viewmodel"],function(a){Curvy.Services.utilities.style(".data-hide","display: none !important;");var b=this,c=b.element.getAttribute("data-show"),d=function(){a.path(c)?b.element.classList.remove("data-hide"):b.element.classList.add("data-hide")};a.watch(c,d),d()}),Curvy.register.binding("data-src",["viewmodel"],function(a){function b(){var b=a.path(d)||"";c.element.setAttribute("src",b)}var c=this,d=c.element.getAttribute("data-src");a.watch(d,b),b()}),Curvy.register.binding("data-submit",["viewmodel"],function(a){var b=this,c=b.element.getAttribute("data-submit");b.element.addEventListener("submit",function(b){b.preventDefault();var d=a.path(c);if("function"==typeof d)return d.apply(a,arguments),!1})}),function(){function a(a,b,c,d){var e=new Curvy.Observable(d);return Object.defineProperty(e,"view",{configurable:!1,enumerable:!0,value:c.view}),Object.defineProperty(e,"parent",{configurable:!1,enumerable:!0,value:c}),Object.defineProperty(e,"dispose",{configurable:!1,enumerable:!0,value:function(c){b.dispose(a,c)}}),b.dispose(function(){e.destroy()}),e.seal(),e}Curvy.register.binding("data-template",["viewmodel","binding-manager"],function(b,c){function d(){var d=b.path(g);d=(d instanceof Array?d.slice(0):[d]).filter(function(a){return"object"==typeof a});for(var e=[];d.length;){for(var j=d.shift();i[0]&&i[0].model!==j;){var k=i.shift();k.element.parentNode.removeChild(k.element)}if(i[0]&&i[0].model===j)e.push(i.shift());else{var l=Curvy.Services.utilities.parse(h),m=a(l,c,b,j);c.override(l,"viewmodel",m);var n=i[0]?i[0].element:f;n.parentNode.insertBefore(l,n),e.push({model:j,element:l})}}i=e}this.suspend();var e=this.element,f=document.createComment("Template Content"),g=e.getAttribute("data-template");e.removeAttribute("data-template");var h=e.outerHTML;e.parentNode.insertBefore(f,e),e.parentNode.removeChild(e);var i=[];b.watch(g,d),d()})}(),Curvy.register.binding("data-title",["viewmodel"],function(a){function b(){var b=a.path(d)||"";c.element.setAttribute("title",b)}var c=this,d=c.element.getAttribute("data-title");a.watch(d,b),b()}),Curvy.register.binding("data-view",function(){this.suspend();var a=this.element,b=a.getAttribute("data-view"),c=document.createComment("view: "+b);a.parentNode.insertBefore(c,a),a.parentNode.removeChild(a);var d=new XMLHttpRequest;d.onreadystatechange=function(){if(4===this.readyState&&"string"==typeof this.responseText){for(var a=c.parentNode;a&&a!==document;)a=a.parentNode;if(a){var b=Curvy.Services.utilities.parse(this.responseText);b=b instanceof Array?b:[b];for(var d=0;d<b.length;d++)c.parentNode.insertBefore(b[d],c)}}},d.open("get",b),d.send()}),function(){function a(a,b){a.register("viewmodel",b),a.dispose(function(){b.destroy()})}Curvy.Bindings.ViewModel=function(b,c){var d=this,e=d.element.getAttribute("view-model");if(!e)throw"Invalid ViewModel";var f=b.resolve(e,c,d);if(f)a(d,f);else{var g=d.suspend();b.postpone(e,function(){a(d,b.resolve(e,c,d)),g()})}},Curvy.register.binding("view-model",["viewmodel-manager","viewmodel"],Curvy.Bindings.ViewModel)}();